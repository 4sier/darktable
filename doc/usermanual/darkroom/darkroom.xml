<chapter>
<chapterinfo>
<keywordset>
  <keyword>darkroom</keyword>
  <keyword>view</keyword>
</keywordset>
</chapterinfo>
<title>Darkroom</title> 
  <para>In the darkroom view, you apply various processing modules to
  your raw image to develop it into the final image you imagined when
  you took the picture.
  </para>
  <screenshot>
    <screeninfo>The darkroom view</screeninfo>
    <graphic fileref="images/darkroom_view.png"></graphic>
  </screenshot>

<sect1><title>Overview</title> 
  <para>In the darkroom view, you develop a specific image by applying
  a set of tools (called image processing modules) that modify the
  appearance of the image in specific ways.
  </para>
  <para>In the center of the darktable window, you see the current
  image. In the left panel, you see the navigation, snapshots, color
  picker, and history panels. In the right panel, you see the
  histogram and a list of the image processing modules you can use to
  apply various processing effects to your image. Across the bottom,
  you see a filmstrip of your current lighttable images, where you can
  select another image for processing.
  </para>
  <para>Darktable organizes the image processing modules into several
  groups: active, favorites, basic, tone, color, correction, and
  effect. If you want to see all available modules, click on the
  current group selection, which turns off that group and displays all
  modules.
  </para>
  <para>It doesn't matter in what order you apply changes to your
  images, because Darktable applies the image processing modules to an
  image in a pre-established order. The order of the modules in the
  right panel follows the order darktable will use when applying
  modifications to your image from the bottom to the top. So if you
  enabled every processing module, darktable would start by applying
  the invert module to your image, followed by white balance, and
  continuing through the list until it reached the watermark
  module. While you can change any of the parameters of individual
  processing modules, you cannot change the order that darktable
  applies the modules to the image. Darktable applies the modules in a
  specific order required based on various dependencies between
  modules such as the color processing space the modules use.
  </para>
  <para>If you click the middle mouse button while pointing to the
  image, you will rotate through zoom 1:1, zoom 2:1, and zoom to fit
  modes.
  </para>
  <para>You can export images directly from the darkroom view by
  typing ctrl-e. Darktable will export the image using the parameters
  currenly set export module from the lighttable view.
  </para>
</sect1>


<sect1><title>Left Panel</title>
  <sect2><title>Navigation</title>
    <graphic fileref="darkroom/images/panel_navigation.png" />
    <para>The navigation module displays a thumbnail of the current
    image. If you have zoomed into the image, the navigation module
    displays a white rectangle showing you the current visible part of
    the image. You can use the mouse to drag the rectangle around the
    thumbnail to adjust the current view.
    </para>
  </sect2>

  <sect2><title>Snapshots</title>
    <graphic fileref="darkroom/images/panel_snapshots.png" />
    <para>Pressing the <emphasis>take snapshot</emphasis> button,
    stores a temporary copy of the current image in the main
    view. Darktable names the snapshot with the title of the most
    recertly used image processing module from the history stack. When
    you click on a named snapshot, darktable overlays the snapshot's
    version of your image over the current image for an easy,
    side-by-side comparison.
    </para>
    <para>With the snapshot view enabled, you see a line separating
    the snapshot view from the current image. You can drag the line to
    increase or decrease the amount of the snapshot you see. You can
    also click on the icon at the center of the line to rotate the
    displayed snapshot portion ninety degrees. While you have the
    snapshot image active, you can continue to apply changes to the
    image or click on versions from the history stack to compare that
    version with the snapshot.
    </para>
    <para>Clicking on the named snapshot again, turns off the snapshot
    view. Note that darktable doesn't save the snapshots beyond the
    current development session. If you use the filmstrip to develop
    another image or return to the lighttable view, darktable discards
    the current snapshots.
    </para>
  </sect2>

  <sect2 status="draft"><title>History</title>
    <graphic fileref="darkroom/images/panel_history.png" />
    <para>The historystack lists every change of state
    (activate/de-activated) for all modules.  Here you can select a
    point in stack to return to that point of development history.  If
    you then activate a new module, all modules above the current
    point will be discarded.
    </para>
    <para> Hitting 'compress historystack' generates the shortest
    historystack that produces the current image, i.e. suppressing all
    de-activated modules.
    </para>
    <para>The button to the right lets you create a new styles by
    poping-up a new window.  Use the first line to name your style,
    the second to add a searchable description.  The "advanced
    presets" allows you chose which modules are to be taken into
    account for the styles.
    </para>
  </sect2>

  <sect2 status="draft"><title>Color Picker</title>
    <graphic fileref="darkroom/images/panel_color_picker.png" />
    <para>The color picker . . .
    </para>
  </sect2>

  <sect2 status="draft"><title>Image Information</title>
    <graphic fileref="darkroom/images/panel_image_information.png" />
    <para>Shows the the same image metadata as the image information
    module in the lighttable view show.
    </para>
  </sect2>
</sect1>


<sect1><title>Right Panel</title>  
  <sect2 status="draft"><title>Histogram</title>
  <informaltable frame="none"><tgroup cols="2" colsep="0" rowsep="0">
    <colspec colwidth='70%'/>
    <colspec colwidth='30%'/>
    <tbody>
      <row>						
	<entry>Show a logarithmic histogram of the developed image;
	you can change exposure by left mouse click in the right side
	of histogram and drag right for increase or left to decrease
	the exposure. The same goes for the black level but you left
	click in the left part of histogram.
	</entry>
	<entry>
	  <graphic fileref="darkroom/images/panel_histogram.png" scalefit="1" width="80%" align="center" />
	</entry>
      </row>
    </tbody>
  </tgroup>
  </informaltable>
  </sect2>

  <sect2 status="final"><title>Image Processing Modules</title>
    <para>Each correction, enhancement or effect is implemented as modules, and this section includes documentation
    of each module and its specific parameters.
    A module consists of an expander bar <inlinegraphic fileref="&img_module_expander;" scalefit="1" width="30%" align="center"/>  
    where the <inlinegraphic fileref="&icon_module_enable;" scalefit="1" width="2%"  align="center"/> icon  is used to turn then module
    on or off, then there are a title of the module press this to expand the module to see the parameters user interface.
    <inlinegraphic fileref="&icon_module_presets;" scalefit="1" width="2%" align="center" /> icon is the preset icon to access the available presets stored for the module or to create new ones. 
    The <inlinegraphic fileref="&icon_module_reset;" scalefit="1" width="2%" align="center"/>  icon is used to reset the module parameters to their default values.
    </para>
    <sect3 status="draft"><title>Interacting with modules</title>
      <para>For each slider, you can interact in three different ways, depending on the level of control you need.
      </para>
      <orderedlist>
	<listitem>
	  <para>Arrows</para>
	  <para> You can use the arrows around the slider to control precisely the increase/decrease of the value.
	  </para>
	</listitem>
	<listitem>
	  <para>Mouse wheel</para>
	  <para>Hover a slider with your mouse, then use your mouse wheel to adjust by step the value.
	  </para>
	</listitem>
	<listitem>
	  <para>Right-click</para>
	  <para>Your mouse being over a slider, right-click gives you numerical access the slider values.
	  Note that the numerical value needed to be entered is sometimes different from the one displayed.
	  For example, the percentage repartition is displayed as X/Y (eg 70/30) but numerical value to be entered
	  is -1 for 0/100, 0 for 50/50 and 1 for 0/100.
	  </para>
	</listitem>		
	<listitem>
	  <para>Double-click on parameter label</para>
	  <para>In some modules, you can double-click on a parameter label to reset its value to default.
	  </para>
	</listitem>		   
      </orderedlist>
    </sect3>
    <sect3 status="draft"><title>Blending operators</title>
      <para>Blending operators are a blend functionality that works on the incoming image information and 
      the output of the current module. Not all modules support blending because it would not work
      and break the use of the module.
      </para>
      <para>Modules that do support blending, inherit additional controls at the bottom of module userinterface to control
      parameters of the blending.
      </para>
    </sect3>
    <!--
	<sect3><title>Operators</title>
	<para>There are a few operators implemented and more can be added, but for now the common ones are there and
	you will recognize a few of them from other imaging softwares.
	</para>
	<sect4 status="draft"><title>Normal</title>
	<para>This will probably be the most used blending operator, it does just mix input and output and will be used
	to control the modules effect amount for an example. Perfect for better controlling raw denoise result.
	</para>			
	</sect4>
	<sect4 status="draft"><title>Lighten</title>
	<para></para>			
	</sect4>
	<sect4 status="draft"><title>Darken</title>
	<para></para>			
	</sect4>
	<sect4 status="draft"><title>Multiply</title>
	<para></para>			
	</sect4>
	<sect4 status="draft"><title>Average</title>
	<para></para>			
	</sect4>
	<sect4 status="draft"><title>Add</title>
	<para></para>			
	</sect4>
	<sect4 status="draft"><title>Substract</title>
	<para></para>			
	</sect4>
	<sect4 status="draft"><title>Difference</title>
	<para></para>			
	</sect4>
	<sect4 status="draft"><title>Screen</title>
	<para></para>			
	</sect4>
	<sect4 status="draft"><title>Overlay</title>
	<para></para>			
	</sect4>
	<sect4 status="draft"><title>Soft light</title>
	<para></para>			
	</sect4>
	<sect4 status="draft"><title>Hard light</title>
	<para></para>			
	</sect4>
	<sect4 status="draft"><title>Vivid light</title>
	<para></para>			
	</sect4>
	<sect4 status="draft"><title>Linear light</title>
	<para></para>			
	</sect4>
	<sect4 status="draft"><title>Pin light</title>
	<para></para>			
	</sect4>
	</sect3> -->
      
    <sect3><title>Examples</title>
      <sect4 status="draft"><title>Texturing an image</title>
        <para>The watermark module supports svg files with embedded images and thanks to it we can easily texture an 
	image using the watermark module in conjunction with a blending operator.
	</para>
      </sect4>
      
      <sect4 status="draft"><title>Gritty details</title>
        <informaltable frame="none"><tgroup cols="2" colsep="0" rowsep="0">
	  <colspec colwidth='70%'/>
	  <colspec colwidth='30%'/>
	  <tbody>
	    <row>						
	      <entry>When blending operators were introduced into
	      darktable, a new module named highpass was added. It
	      produces a highpass filter of the image to be
	      implicitly used with blending. It allows to produce a
	      gritty detailed image and is a widely used workflow
	      with other imaging softwares.
	      </entry>
	      <entry>
		<graphic fileref="darkroom/modules/images/blendop_highpass.png" scalefit="1" width="80%" align="center" />
	      </entry>
	    </row>
	  </tbody>
	</tgroup>
	</informaltable>
	
	<para>
	  <informaltable frame="none"><tgroup cols="2" colsep="0" rowsep="0">
	    <colspec colwidth='30%'/>
	    <colspec colwidth='70%'/>
	    <tbody>
	      <row>
		<entry>
		  <graphic fileref="darkroom/modules/images/blendop_highpass_ex1_1.png" scalefit="1" width="90%" align="center" />
		</entry>						
		<entry>
		  <para>This is the original image, pretty heavy
		  processed: first black and white, then some blue
		  splittoning but as you see it lacks pop in details
		  and is a bit out of focus...
		  </para>
		</entry>
	      </row>
	      <row>
		<entry>
		  <graphic fileref="darkroom/modules/images/blendop_highpass_ex1_2.png" scalefit="1" width="90%" align="center" />
		</entry>						
		<entry>
		  <para>Here we applied the highpass filter with the values shown in the images above of the module userinterface; 
		  you can now see that the details are very boosted and we got a really gritty detailed image.
		  </para>
		</entry>
	      </row>
	    </tbody>
	  </tgroup>
	  </informaltable>
	</para>
      </sect4>
      
    </sect3>
    <sect3 status="final"><title>Presets</title>
      <para>
	Presets are stored configurations for the module parameters
	both internal and user-defined is available through clicking
	the <inlinegraphic fileref="&icon_module_presets;"
	scalefit="1" width="2%" align="center"/> icon and a list of
	available presets are shown for your choice, the activated
	preset is in bold text.
      </para>
      <para>
	The preset system does also support automatic preset selection
	based on image data such as focal length, iso, camera model
	and much more fields.
      </para>
      <sect4><title>Creating a new preset</title>
        <para>
	  Configure the specific module of choice as you like then you click the <inlinegraphic fileref="&icon_module_presets;"  scalefit="1" width="2%" align="center"/> icon and select
	  store new preset menu choice.
	  Following dialog will be shown to configure the preset:
	</para>
	<graphic fileref="darkroom/modules/images/new_preset.png" scalefit="1" width="60%" align="center" />
	<para>
	  The first two fields are used for setting a name and a description of the preset.
	</para>
	<para>
	  In the example i have also checked the auto apply option
	  which brings up the image selection fields where you can
	  define a filter that is used to decide if the preset should
	  be applied the image or not.  The example dialog above does
	  set up following rules, if lens name matches and aperture is
	  >= 8 and focal length is in range 24 - 35mm the preset will
	  be automatically applied, it will also only show in the
	  preset list if the image does match this rule.
	</para>
	<para>
	  The data used is the EXIF information so if you want a
	  preset to be applied to all images from a specific camera,
	  then leave all fields at default values, lookup model string
	  in metadata panel and enter it into the model field.
	</para>
	
      </sect4>
    </sect3>
  </sect2>
  <sect2><title>More Plugins</title>
    <para>Placeholder for description of the more plugins module.</para>
  </sect2>
</sect1>

<sect1><title>Filmstrip</title>
  <para>The filmstrip is used to quickly switch between image to develop in darkroom view, the images viewed are the same
  as the ones in the lighttable view. 
  </para>
  <para>The filmstrip can be switch on and off using <emphasis>ctrl-f</emphasis> shortcut.</para>
</sect1>
  
<sect1><title>Image Development Examples</title>
&darkroom_example_crossprocessing;
&darkroom_example_cyantone;
&darkroom_example_blackandwhite;
</sect1>
</chapter>

&darkroom_modules;


